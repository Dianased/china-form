document.addEventListener("DOMContentLoaded",()=>{"function"==typeof updateTimer&&(updateTimer(),setInterval(updateTimer,1e3)),"function"==typeof checkVisibility&&(checkVisibility(),window.addEventListener("scroll",checkVisibility));const e=document.getElementById("contactForm");if(!e)return;document.getElementById("result");const t=e.querySelector('button[type="submit"]');e.addEventListener("submit",async s=>{s.preventDefault(),t.disabled=!0,showResult("",""),showResult("Отправка...","loading");try{const t=await fetch(e.action,{method:"POST",body:new FormData(e),headers:{"X-Requested-With":"XMLHttpRequest"}});if(!t.ok)throw new Error("Server error");const s=await t.json();if(!s||"string"!=typeof s.message)throw new Error("Invalid response");showResult(s.message,s.success?"success":"error"),s.success&&e.reset()}catch(e){console.error(e),showResult("Ошибка соединения. Попробуйте позже.","error")}finally{t.disabled=!1}})});